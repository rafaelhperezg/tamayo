<div class="container">
  <div class="row">
    <div class="col-xs-12 col-sm-6">
      <h2 class="text-center">Cash</h2>
      <div class="dashboard-box">
        <div class="dashboard-box-item">
          <h3><%= @enterprise.current_cash %>€</h3>
          <span>Beginning of the day</span>
        </div>
        <div class="dashboard-box-item">
          <h3 class="<%= (-500 > 0) ? 'green' : 'red'%>"><%= @net_result_today %>€</h3>
          <span>Net results today</span>
        </div>
        <div class="dashboard-box-item">
          <h3><%= @enterprise.est_new_cash %>€</h3>
          <span>Estimated treasury</span>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6">
      <h2 class="text-center">Production</h2>
      <div class="dashboard-box">
        <div class="dashboard-box-item">
          <h3 data-toggle="tooltip" data-placement="top" title="<%= @previous_backlog%> unproduced items from yesterday."><%= @previous_backlog%> items</h3>
          <span>orders backlog</span>
        </div>
        <div class="dashboard-box-item">
          <h3><%= @today_orders_received %> items</h3>
          <span>orders today</span>
        </div>
        <div class="dashboard-box-item">
          <h3><%= @total_to_produce_today%> items</h3>
          <span>total</span>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-sm-6">
      <h2 class="text-center">Costs</h2>

      <div class="resource-card">
        <div class="resource-card-item resource-card-number">
          <p data-toggle="tooltip" data-placement="top" title="You have <%= pluralize(@current_number_of_employees, 'employee') %>">
          <span class="employeesamount"><%= @current_number_of_employees %></span> X
            <i class="fa fa-users"></i>
          </p>
        </div>
        <div class="resource-card-item">
          <p>
            <span class="employeessalaries"><%= @cost_of_salaries_for_today %></span>€
          </p>
          <span>(100€ / day)</span>
        </div>
      </div>
      <div class="resource-card">
        <div class="resource-card-item resource-card-number">
          <p data-toggle="tooltip" data-placement="top" title="You need to buy <%= @today_orders_received %> items"><%= @today_orders_received %> X <i class="fa fa-industry"></i></p>
        </div>
        <div class="resource-card-item">
          <p><%= @gamesession.material_cost * @today_orders_received %>€</p>
          <span>(<%= @gamesession.material_cost %>€ / item)</span>
        </div>
      </div>

      <div class="resource-card">
        <div class="resource-card-item resource-card-number">
          <p data-toggle="tooltip" data-placement="top" title="Costs for hirings and layoffs">Hires/Layoffs</p>
        </div>
        <div class="resource-card-item">
          <p><%= @cost_of_hiring_and_firing_for_today %>€</p>
          <span data-toggle="tooltip" data-placement="right" title="Hiring 1 employee costs <%=@gamesession.hiring_cost%>€; firing one costs <%=@gamesession.firing_cost%>€"><%=@gamesession.hiring_cost%>€/<%=@gamesession.firing_cost%>€</span>
        </div>
      </div>
      <div class="resource-card">
        <div class="resource-card-item resource-card-number">
          <p>Total</p>
        </div>
        <div class="resource-card-item">
          <p>
          <span class="totalcosts"><%= @total_money_spent_today %></span>€
          </p>
        </div>
      </div>
    </div>
<!-- ORDERS -->
    <div class="col-xs-12 col-sm-6">
      <div class="dashboard-form">
        <div class="dashboard-control">
          <div class="dashboard-control-label">
            <h3>Delay <i class="fa fa-clock-o pull-right"></i></h3>
          </div>
          <div class="dashboard-control-input text-right">
            <%= @when_can_todays_orders_be_delivered + 1 %> days
          </div>
        </div>
<% if false %>
        <div class="dashboard-control text-center">
          <div class="dashboard-control-title">
            <h3>Decision</h3>
          </div>
        </div>
<% end %>
        <div class="dashboard-control">
          <div class="dashboard-control-label">
           <h3>Contract <i class="fa fa-book pull-right"></i></h3>
          </div>
          <div class="dashboard-control-input text-right">
            <input type="checkbox" id="toggle" data-toggle="toggle" data-off="court" data-onstyle="danger" data-on="long" data-offstyle="success" name="enterprise[contract]">
          </div>
          <%= f.input :new_contract_id, as: :hidden, input_html: {value: @contract.id}  %>
        </div>
        <div class="dashboard-control">
          <div class="dashboard-control-label">
            <h3><span class="employee_variation label label-default">0</span> x employees <i class="fa fa-users pull-right"></i></h3>
          </div>
          <div class="dashboard-control-input text-right">
            <ul class="list-inline">
              <li><a href="" class="btn btn-default" id="buttonsplus"><i class="fa fa-plus"></i></a></li>
              <li><a href="" class="btn btn-default" id="buttonsminus"><i class="fa fa-minus"></i></a></li>
              <%= f.input :employees_variation, as: :hidden, input_html: {value: '0'} %>
            </ul>
          </div>
        </div>
      </div>
      <% if false %>
        <p>Currently selected contract:</p>
        <span><%= @contract.name %></span>
        <p>(delivery within <%= @contract.timeframe %> days)</p>
      <% end %>
<%#= f.button :submit, class: "btn btn-success margined" %>
    </div>
<!-- /ORDERS -->
  </div>
</div>




<%= content_for(:js) do %>
  <script>
  $(document).ready(function() {
// Tooltips         //////////////////////////////////////
    $("body").tooltip({ selector: '[data-toggle=tooltip]' });
////////////////////////////////////



// Toggle contract //////////////////////////////
    $('#toggle').bootstrapToggle({
      on: "long",
      off: "court"
    });

    var contractId = <%= @contract.id %>;
      if (contractId == 2) {
        $('#toggle').bootstrapToggle("on");
      }

    $('#toggle').change(function() {
      var contractId = $("#game_decision_new_contract_id").val();
        if (contractId == 1) {
          $("#game_decision_new_contract_id").val(2);
          $(".contract_name").text("long");
        } else {
          $("#game_decision_new_contract_id").val(1);
          $(".contract_name").text("court");
        }
      });
//////////////////////////////////////////



// Employee variation ////////////////////
var employeescounter = <%= @current_number_of_employees %>;
var employeessalaries = <%= @current_number_of_employees %> * <%= @gamesession.salary_per_employee %>;
var totalcosts = <%= @total_money_spent_today %>;

    $("#buttonsplus").click(function(e){
      e.preventDefault();
      var variation = parseInt($("#game_decision_employees_variation").val());
      $("#game_decision_employees_variation").val( variation + 1);
      $(".employee_variation").text(variation + 1);
      employeescounter ++;
      employeessalaries = employeescounter * <%= @gamesession.salary_per_employee %>;
      totalcosts = employeessalaries + <%= @cost_of_raw_materials_for_today %>;
      $(".employeesamount").text(employeescounter);
      $(".employeessalaries").text(employeessalaries);
      $(".totalcosts").text(totalcosts);
    });

    $("#buttonsminus").click(function(e){
      e.preventDefault();
      var variation = parseInt($("#game_decision_employees_variation").val());
      $("#game_decision_employees_variation").val( variation - 1);
      $(".employee_variation").text(variation - 1);
      employeescounter --;
      employeessalaries;
      totalcosts = employeessalaries + <%= @cost_of_raw_materials_for_today * @today_orders_received %>;
      $(".employeesamount").text(employeescounter);
      $(".employeessalaries").text(employeessalaries);
      $(".totalcosts").text(totalcosts);
    });
  });
//////////////////////////////////////////
  </script>
<% end %>


<%# raise %>



